# https 加密过程

为什么要有https加密？

http请求都是明文传输，容易被中间人攻击。https是在发起tcp请求之前加了一个安全层，
SSL/TLS
演变过程
1. 只有对称加密
对称加密：加密和解密都是相同的秘钥
对称加密过程，客户端给服务端发送 加密方式列表（加密套件）和客户端随机数（client_random）。服务端收到后返回加密方式列表（加密套件）和服务端随机数
。后续的请求根据客户端随机数和服务端随机数生成密钥通信。
缺点：客户端随机数和服务端随机数是明文传递，会被劫持。

2. 采用非对称加密
非对称加密：非对称加密有两个秘钥 A，B。A加密只能用B解密，B加密只能A解密。
加密过程：
服务器保存私钥，把公钥发给浏览器
1. 浏览器向服务器发送加密套件
2. 服务器返回加密套件和公钥

缺点： 
1.服务器发送给浏览器的数据不安全，因为谁都能获得到公钥。
2.加密的效率太低


3. 非对称对称一起用
在传输的阶段使用对称加密传输，密钥采用非对称传输
1. 浏览器向服务器发送对称加密套件+非对称加密套件+客户端随机数
2. 服务器收到后，返回公钥+对称加密套件+非对称加密的套件+服务端随机数
3. 浏览器保存公钥，生成随机数，用公钥对随机数进行加密生成pre-master，发送给服务端
4. 服务端根据私钥揭秘pre-master,揭秘后发送确认信息到客户端
后续请求使用 客户端随机数+服务端随机数+pre-master 生成密钥进行对称加密交流

4. 使用数字证书
非对称和对称加密一起用还是存在问题的，如果黑客篡改了DNS，把请求ip替换成自己的ip，黑客自己实现公钥和私钥，对于浏览器来书，他不知道访问的是黑客的站点。
服务器怎么证明自己呢？通过证书来证明，
证书的作用：通过证书向浏览器证明服务器的身份，另一个是数字证书里包含了服务器的公钥
传输过程：
在第三版的基础上把公钥换成了证书。
浏览器多了一个证书验证过程。

证书如何验证？
1. 浏览器根据证书中的相关明文信息，采用CA签名时相同的hash函数来得到信息摘要A，同事再利用公钥解密签名数据，得到B，如果A B 一致，则证书时合法的。












